Pearson’s Chi-square test, discussed in the previous lecture, is probably the most common hypothesis test used for comparing two categorical variables. It is applicable to tables of almost any size, can be (fairly) easily calculated by hand, and requires few assumptions. However, it is not valid if the number of counts in any of the cells are small. The most common alternative test in that case is Fisher’s exact test. Fisher’s exact test can in principle be used for tables of any size, just as Pearson’s Chi-square test can, but it is most commonly used for 2x2 tables.

Let’s work through Fisher’s exact test, using the same TMS and Migraine Pain example we used in the previous lecture. [Note: Even though there was not a “small sample” issue with this study, we are using the same example for demonstration purposes only.]Recall that the research question for the TMS and Migraine Pain study is: Is study group (TMS vs. control) associated with migraine headache pain status (pain-free or not) after two hours? 

Fisher’s exact test can also answer this kind of research question: are the two categorical variables associated with each other or not? Before we can carry out any inferential method, we first need to evaluate the assumptions of the method. There are two assumptions for Fisher’s exact test. They are: 

The sample should be a random (or representative) sample from the population, to allow us to generalize the results to that population; 

The observations should be independent of one another. This assumption would be violated if the participants in the study were related in some way to each other (e.g., siblings) or if the observations in one group were related in some way to those in another group, for example, if the participants in the groups were matched or paired. If the observations are paired, then McNemar’s test should be used instead.

If these assumptions are not met, then the results of the test will not be valid and alternative methods should be used instead. 

As we discussed in the previous lecture, the first two assumptions seem reasonable, as far as we can tell, for the TMS and Migraine Pain study.The hypotheses for Fisher’s exact test are precisely the same as for Pearson’s Chi-square test:

The null hypothesis defines the skeptical perspective or the “nothing is going on” situation. When we are looking to see if two variables are associated, the skeptical perspective is that they aren’t associated at all; they are not related in any way; they are independent.

For the TMS and Migraine Pain example, the null hypothesis is that pain status (pain-free or not) and study group (TMS or sham control) are independent of each other in the population of migraine sufferers.

The alternative hypothesis, on the other hand, defines the competing claim, the thing we are interested in finding evidence for. In this case, that the two variables are indeed associated with or related to each other and not independent.

For the TMS and Migraine Pain example, the alternative hypothesis is that pain status (pain-free or not) and study group (TMS or sham control) are NOT independent of each other in the population of migraine sufferers; that is, that there is an association or relationship of some kind between them.For Fisher’s exact test, we evaluate the claims in the usual way up to a point:
We collect evidence (data), and
We summarize the data using exploratory data analysis (a contingency table and perhaps the marginal and conditional probabilities).

However we do NOT calculate a test statistic to measure the compatibility between the data and the null hypothesis. For Fisher’s exact test, there is no test statistic. A p-value is calculated directly from the table data, using a computer. Let’s explain how this works using our TMS and Migraine Pain example.Fisher’s exact test first assumes that the marginal counts are fixed at the observed values: one-hundred people in each study group (TMS and control), and 61 people who were pain-free and 139 people who were not pain-free after two hours. The computer then determines how many possible ways there are to arrange the 200 people in the study among the four cells (a, b, c and d) and still keep the marginal counts as they are. 

There would be a lot of possible ways! For example, the arrangement we actually observed was a = 39, b = 61, c = 22, and d = 78, as shown in the table above. Another arrangement that has the SAME marginal counts could be obtained by moving one participant from a to b and balance it by moving another participant from d to c, so a = 38, b = 62, c = 23, and d = 77. This pattern could be continued until you reach a = 0, b = 100, c = 61 and d = 39. And this is not all of the possible arrangements!Next, for each arrangement, the computer calculates the probability of seeing that particular combination of values. The resulting p-value is found by adding up the probabilities from the observed table and every other “unusual” table. (Note: A table is deemed “unusual” if it has a probability less than or equal to the observed table.) The Fisher’s exact test p-value tells us how unusual it is to see this particular set of table data, or one more extreme, IF the two variables are not associated. If the total probability of such unusual tables is “small”, we can reject the null hypothesis and have evidence for the alternative. 

While there is agreement on how to compute one-sided p-values for Fisher’s exact test, there is not agreement on how to compute two-sided p-values (and this is most often the value of interest). We just described one approach for how to deal with two-sided p-values (one that we think is easy to understand), but be aware that some software programs might use a different method. 

For the TMS and Migraine Pain study, the two-sided Fisher’s exact p-value is 0.0137.As usual, once we have the p-value, we make a conclusion about the strength of evidence we have against the null hypothesis by comparing the p-value to the significance level, alpha. If the p-value is less than alpha, we reject the null hypothesis and say we have evidence against the null in favor of the alternative hypothesis. 

For the TMS and Migraine Pain study, with a significance level (alpha) set to 0.05, we reject the null hypothesis because the p-value of 0.0137 is less than 0.05. Therefore we conclude that there is evidence that pain status (pain free or not) after two hours is associated with study group (TMS or control) in this population of migraine sufferers. 

Note that our conclusion is the same using Fisher’s exact test (p-value = 0.0137) as it was previously using Pearson’s Chi-square test (p-value = 0.009). The two tests will not always agree, however, particularly when the sample size is small.

Since we have rejected the null hypothesis, we could go on to say that it appears more participants in the TMS group experienced pain relief after two hours than in the control group (39% vs. 22%).We have now discussed two hypothesis tests that can be used for comparing two categorical variables: Pearson’s Chi-square test and Fisher’s exact test. How do we decide which one to use? There are some tradeoffs.

Pearson’s Chi-square test is approximate; the Chi-square test statistic only has a perfectly Chi-square sampling distribution as the sample size goes to infinity, but it is close enough as long as there are more than 5 counts in all of the table cells. Fisher’s exact test does not require a large sample size, and in fact is easier to calculate for small samples. 

Historically, Pearson’s Chi-square test was used because the test statistic could be calculated by hand. Fisher’s exact test didn’t become common until computers were readily available to do the calculations… but for REALLY large tables or very large sample sizes, even computers will take too long to calculate the Fisher’s exact p-value. 

So what to do? There are several schools of thought on this. 

One view is that Pearson’s Chi-square test should be the default choice, with Fisher’s exact test used only when any cell count is less than 5.

Another view is that, since all statistical analysis is done using computers now, Fisher’s exact test should be the default choice, with Pearson’s used only when the sample size is so large or the table dimensions so big that Fisher’s won’t calculate.

Both of these views are completely reasonable and you may choose to follow whichever one you wish. Just make sure to report the method you chose. 

What should you NOT do? You should definitely NOT carry out both tests, and if they disagree, choose the one that gives you the result you prefer. This is considered statistically unethical. (The two tests will sometimes disagree, particularly when the sample size is small.) You should decide in advance which one test is appropriate, using either of the views described above, and carry out that test.